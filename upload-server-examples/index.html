<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" c4ontent="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="Safraz Razik">
    <meta name="generator" content="Jekyll v3.8.6">

    <title>Upload Server Examples - Vue File Agent</title>


    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://safrazik.github.io/vue-file-agent/assets/github-markdown.css">
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vue-file-agent@latest/dist/vue-file-agent.css">
  </head>
  <body>
    <div id="app">
      <section class="text-center p-3" style="background: #333">
        <div>              
          <h3>
            <a href="/vue-file-agent/">
              Vue File Agent
            </a>
          </h3>
          <div style="color: #ACB5BD">
            <p>
              Every file deserves to be treated equally
            </p>
          </div>
        </div>
        <nav>
          <a href="https://github.com/safrazik/vue-file-agent" target="_blank">Github</a>
        </nav>
      </section>

      <div class="container">
        <div id="docs" name="docs"></div>
        <div class="markdown-body" style="margin: 40px 0;" v-pre>
          <h1 id="upload-server-examples">Upload Server Examples</h1>

<h2 id="node-js">Node Js</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd upload-server-examples/node
npm install
node upload-server.js
</code></pre></div></div>

<p>Change Upload URL to: <code class="highlighter-rouge">http://localhost:3000/upload</code></p>

<h2 id="php">PHP</h2>

<p>Copy <code class="highlighter-rouge">upload-server-examples</code> into your web accessible directory (e.g: <code class="highlighter-rouge">/var/www</code> or <code class="highlighter-rouge">htdocs</code>)</p>

<p>Change Upload URL to: <code class="highlighter-rouge">http://localhost/upload-server-examples/php/upload-server.php</code></p>


        </div>
      </div>
      <div class="container">
        <demo-advanced></demo-advanced>
      </div> 
      <div class="bg-secondary text-white mt-5 py-3">
        <div class="container">
          <div class="text-center">
            Made with love from <a class="text-white" href="https://twitter.com/safrazik" target="_blank">@safrazik</a>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/es6-promise/4.1.1/es6-promise.auto.js" integrity="sha256-qq7wfY6gQJldAy+TGLT7UF/TqnfV4XFzGF/RzrVXq24=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue-file-agent@latest/dist/vue-file-agent.umd.js"></script>

      <script type="text/javascript" id="demo-basic-script">
    window.components = {};
  </script>
  <script type="text/x-template" id="demo-basic-template">
    
<div class="appa">
  <VueFileAgent
    v-model="filesData"
    @select="filesSelected($event)"
    deletable
    @delete="fileDeleted($event)"
  ></VueFileAgent>
<!--   <div>
    Move: <input type="number" ref="moveInput" value="1">
    <button @click="moveIndex(-1)">&lt;&lt;</button>
    <button @click="moveIndex(1)">&gt;&gt;</button>
  </div> -->
  <!-- </div> -->
<!--   <div>
    <button @click="removeAll()">Remove All</button>
    <input type="number" ref="removeIdx" value="1">
    <button @click="remove()">Remove</button>
    <button @click="sortBy('lastModified')">Sort by Last Modified</button>
    <button @click="sortBy('name')">Sort by Name</button>
  </div> -->
  <!-- </div></div> -->
</div>

  </script>
  <script type="text/javascript" id="demo-basic-script">
    (function(){
      var filesBaseUrl = '/vue-file-agent/website/assets/files/';

var videoData = {"name":"Cat Licking Its Paw.mp4","lastModified":1565241222998,"sizeText":"433 KB","size":443767,"type":"video/mp4","ext":"mp4"};
videoData.videoThumbnail = filesBaseUrl + '/Cat Licking Its Paw-thumb.png';
videoData.imageColor = [66, 62, 45];

var filesData = [];
[
  {"name":"sample.pdf","lastModified":1565232623243,"sizeText":"3 KB","size":3028,"type":"application/pdf","ext":"pdf"},
  {"name":"DSC_0261.jpg","lastModified":1564648335292,"sizeText":"64 KB","size":65762,"type":"image/jpeg","ext":"jpg"},
  {"name":"Important sheet.ods","lastModified":1564392646095,"sizeText":"0 B","size":0,"type":"","ext":"ods"},
  videoData,
  {"name":"Collection of something.zip","lastModified":1564392646087,"sizeText":"0 B","size":0,"type":"application/x-zip-compressed","ext":"zip"},
  {"name":"Document 3.doc","lastModified":1564392646097,"sizeText":"0 B","size":0,"type":"","ext":"doc"},
].forEach(function(fd){
  fd.url = filesBaseUrl + fd.name;
  // fd.progress = 10;
  filesData.push(fd);
});

var component = {
  data: function(){
    return {
      lastProgress: 0,
      filesData: filesData,
      uploadUrl: 'https://www.mocky.io/v2/5d4fb20b3000005c111099e3',
    };
  },
  methods: {
    demonstrate: function(){
      if(this.lastProgress >= 100){
        return;
      }
      setTimeout(function() {
        this.lastProgress = this.lastProgress + 5;
        this.filesData[0].progress(this.lastProgress);
        this.demonstrate();
      }.bind(this), 400);
    },
    filesSelected: function(filesData){
      // manual handling
      // this.$refs.vueFileInput.upload(this.uploadUrl, filesData);
    },
    fileDeleted: function(fileData){
      // manual handling
      // this.$refs.vueFileInput.deleteUpload(this.uploadUrl, fileData);
    },
  },
  mounted: function(){
    // console.log('bali this.filesData', this.filesData);
    // this.demonstrate();
  }
}
      component.template = '#demo-basic-template';
      // Vue.component('demo-basic', component);
      components['demo-basic'] = component;
    })();
  </script>

  <script type="text/x-template" id="demo-advanced-template">
    
<div class="appa">

  <div class="card card-body mb-3">
    <div class="row mx-n2">
      <div class="col-md-6 px-2">
        <div class="input-group input-group-sm mb-2">
          <div class="input-group-prepend">
            <span class="input-group-text"><small>:accept</small></span>
          </div>
          <input class="form-control" type="text" v-model="valAccept" placeholder="e.g: image/*,video/*">
          <div class="input-group-append">
              <a class="btn btn-warning" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/file#Unique_file_type_specifiers" target="_blank">
                ?
              </a>
          </div>
        </div>
      </div>
      <div class="col-md-3 col-6 px-2">
        <div class="input-group input-group-sm mb-2">
          <div class="input-group-prepend">
            <span class="input-group-text"><small>:maxSize</small></span>
          </div>
          <input class="form-control" type="text" v-model="valMaxSize" placeholder="e.g: 500KB, 2.5MB, 1GB">
        </div>
      </div>
      <div class="col-md-3 col-6 px-2">
        <div class="input-group input-group-sm mb-2">
          <div class="input-group-prepend">
            <span class="input-group-text"><small>:maxFiles</small></span>
          </div>
          <input class="form-control" type="number" v-model="valMaxFiles" placeholder="e.g: 4">
        </div>
      </div>
    </div>
    <div>
      <div class="input-group input-group-sm">
        <div class="input-group-prepend">
          <span class="input-group-text"><small>Upload URL</small></span>
        </div>
        <input id="advanced-demo-upload-url" class="form-control" type="text" v-model="uploadUrl">
      </div>
    </div>
  </div>

  <VueFileAgent
    ref="vueFileAgent"
    :multiple="true"
    :deletable="true"
    :accept="valAccept"
    :maxSize="valMaxSize"
    :maxFiles="valMaxFiles"
    :helpTextOld="'Choose images or zip files'"
    :errorTextOld="{
      type: 'Invalid file type. Only png or zip Allowed',
      size: 'Files should not exceed 10MB in size',
    }"
    :meta="true"
    @select="filesSelected($event)"
    @delete="fileDeleted($event)"
    v-model="filesData"
  ></VueFileAgent>


  <div class="card card-body mt-3">

    <div class="form-inlinex">

<div class="row">
  <div class="col-md-6">
    <div v-if="!filesData.length">
      No files selected
    </div>
    <div class="form-inline" v-if="filesData.length">
      <label class="my-1 mr-2" for="file-select-index">With File:</label>
<!--       <select ref="fileIdx" class="custom-select my-1 mr-sm-2" id="file-select-index" v-model="selectedIdx">
        <option v-for="i in filesData.length" :value="i">{{ i }}</option>
      </select> -->
    <!-- </div><div> -->
      <button type="button" class="btn mr-1 mb-1" v-for="(fileData, i) in filesData"
      :class="{'btn-secondary': selectedIdx == i+1, 'btn-light': selectedIdx != i+1}"
      @click="selectedIdx = i+1"
      >
        <!-- <span class="badge badge-secondary" :style="{'background-color': fileData.color}"> -->
          {{ i + 1 }}
        <!-- </span> -->
      </button>
    </div>

</div>
<div class="col-md-6">

<div class="row">
      <div class="col-md-12">
        <label class="my-1 mr-2" for="set-progress-range">Set Progess to:</label>
      </div>
      <div class="col-md-12">
        <input type="range" min="0" max="100" ref="prgInput" @input="setProgress()" @change="setProgress()" id="set-progress-range" class="custom-range">
      </div>
</div>



      <button type="button" class="btn btn-outline-secondary mb-2" @click="moveIndex(-1)">&lt;&lt;</button>
      <button type="button" class="btn btn-outline-secondary mb-2" @click="moveIndex(1)">&gt;&gt;</button>
      <button type="button" class="btn btn-outline-danger mb-2" @click="remove()">Remove</button>
      <button type="button" class="btn btn-outline-primary mb-2" @click="upload()">Upload</button>
</div>
</div>


<hr>

    <div class="mb-2">
      <button class="btn btn-outline-secondary mb-2"
        :disabled="!filesDataForUpload.length" 
        @click="uploadFiles()"
      >
        Upload Queue ({{ filesDataForUpload.length }})
      </button>

      <button class="btn btn-danger mb-2" :disabled="!filesDataInvalid.length" @click="removeInvalid()">Remove Invalid ({{ filesDataInvalid.length }})</button>

      <button type="button" class="btn btn-outline-danger mb-2" @click="removeAll()" :disabled="!filesData.length">Remove All ({{ filesData.length }})</button>
    </div>
    <div>
    Sort by:
      <button type="button" class="btn btn-outline-secondary mb-2" @click="sortBy('lastModified')">Last Modified {{ sortDirection.lastModified }}</button>
      <button type="button" class="btn btn-outline-secondary mb-2" @click="sortBy('name')">Name {{ sortDirection.name }}</button>
    </div>

    </div>
    <!-- Move: <input type="number" ref="moveInput" value="1"> -->
    <!-- <input type="number" ref="removeIdx" value="1"> -->


    <!-- Set Progress to: -->
<!--     <button @click="setProgress()">
      Set Progress 
    </button> -->
  </div>

</div>

  </script>
  <script type="text/javascript" id="demo-advanced-script">
    (function(){
      var filesBaseUrl = '/vue-file-agent/website/assets/files/';

var videoData = {"name":"Cat Licking Its Paw.mp4","lastModified":1565241222998,"sizeText":"433 KB","size":443767,"type":"video/mp4","ext":"mp4"};
videoData.videoThumbnail = filesBaseUrl + '/Cat Licking Its Paw-thumb.png';
videoData.imageColor = [66, 62, 45];


// // ...
// {
//   name: 'DSC_0261.jpg',
//   lastModified: 1564648335292,
//   sizeText: '64 KB',
//   size: 65762,
//   type: 'image/jpeg',
//   ext: 'jpg',
//   url: '/vue-file-agent/assets/files/DSC_0261.jpg',
// },
// // ...

var filesData = [];
[
  {"name":"sample.pdf","lastModified":1565232623243,"sizeText":"3 KB","size":3028,"type":"application/pdf","ext":"pdf"},
  {"name":"DSC_0261.jpg","lastModified":1564648335292,"sizeText":"64 KB","size":65762,"type":"image/jpeg","ext":"jpg"},
  {"name":"Important sheet.ods","lastModified":1564392646095,"sizeText":"0 B","size":0,"type":"","ext":"ods"},
  videoData,
  {"name":"Collection of something.zip","lastModified":1564392646087,"sizeText":"0 B","size":0,"type":"application/x-zip-compressed","ext":"zip"},
  {"name":"Document 3.doc","lastModified":1564392646097,"sizeText":"0 B","size":0,"type":"","ext":"doc"},
].forEach(function(fd){
  fd.url = filesBaseUrl + fd.name;
  // fd.progress = 10;
  filesData.push(fd);
});

var component = {
  data: function(){
    return {
      filesData: [],
      filesData: filesData,
      filesDataForUpload: [],
      uploadUrl: 'https://www.mocky.io/v2/5d4fb20b3000005c111099e3',
      uploadHeaders: {'X-Test-Header': 'vue-file-agent'},
      sortDirection: {
        lastModified: 'ASC',
        name: 'ASC',
      },
      selectedIdx: 1,
      valAccept: 'image/*,video/*,.pdf,.doc,.docx,.ods',
      valMaxSize: '10MB',
      valMaxFiles: 14,
    };
  },
  computed: {
    filesDataInvalid: function(){
      var filesDataInvalid = [];
      for(var i = 0; i < this.filesData.length; i++){
        if(this.filesData[i].error){
          filesDataInvalid.push(this.filesData[i]);
        }
      }
      return filesDataInvalid;
    },
  },
  methods: {
    getSelectedFileData(){
      var i = this.selectedIdx;
      i = i - 1;
      if(!this.filesData[i]){
        return;
      }
      return this.filesData[i];
    },
    removeAll: function(){
      console.log(this.filesData);
      this.filesData = [];
      this.filesDataForUpload = [];
    },
    setProgress(){
      var fileData = this.getSelectedFileData();
      if(!fileData){
        return;
      }
      var prg = this.$refs.prgInput.value;
      fileData.progress(prg);
    },
    removeInvalid: function(){
      var filesDataNew = this.filesData.concat([]);
      for(var i = 0; i < this.filesDataInvalid.length; i++){
        var idx = filesDataNew.indexOf(this.filesDataInvalid[i]);
        if(idx !== -1){
          filesDataNew.splice(idx, 1);
        }
      }
      var filesDataNew = [];
      for(var i = 0; i < this.filesData.length; i++){
        if(!this.filesData[i].error){
          filesDataNew.push(this.filesData[i]);
        }
      }
      this.filesData = filesDataNew; // mutate at once, do not splice each
    },
    remove: function(){
      console.log('removing...');
      var i = this.selectedIdx;
      i = i - 1;
      if(!this.filesData[i]){
        return;
      }
      this.filesData.splice(i, 1);
    },
    upload: function(){
      console.log('let au debug');
      var fileData = this.getSelectedFileData();
      if(!fileData){
        return;
      }
      if(!(fileData.file && fileData.file instanceof File)){
        alert('This is not a user selected file');
        return;
      }
      var i = this.filesDataForUpload.indexOf(fileData);
      if(i !== -1){
        this.filesDataForUpload.splice(i, 1);
      }
      this.$refs.vueFileAgent.upload(this.uploadUrl, this.uploadHeaders, [fileData]);
    },
    moveIndex: function(dir){
      console.log('moveIndex', dir);
      var index = parseInt(this.selectedIdx) - 1;
      var newIndex = index + dir;
      if(newIndex < 0){
        newIndex = this.filesData.length - 1;
      }
      if(newIndex >= this.filesData.length){
        newIndex = 0;
      }
      var existing = this.filesData[index];
      var adjacent = this.filesData[newIndex];
      this.selectedIdx = newIndex + 1;
      if(!existing || !adjacent){
        return;
      }
      var filesData = this.filesData;
      filesData[newIndex] = existing;
      filesData[index] = adjacent;
      this.filesData = filesData.concat([]); // cause Vue array mutation
    },
    sortBy: function(prop){
      // var asc = this['_is_sorted_desc_' + prop] = !this['_is_sorted_desc_' + prop];
      var direction = this.sortDirection[prop];
      this.sortDirection[prop] = direction == 'DESC' ? 'ASC' : 'DESC';
      // console.log('sortBy', prop, this.filesData);
      var ret = direction == 'DESC' ? -1 : 1;
      this.filesData = this.filesData.sort(function(fd1, fd2){
        return fd1.file[prop] > fd2.file[prop] ? 1*ret : -1*ret;
      });
      // console.log('sortBy after', prop, this.filesData);
    },



    uploadFiles: function(){
      // Using the default uploader. You may use another uploader instead.
      this.$refs.vueFileAgent.upload(this.uploadUrl, this.uploadHeaders, this.filesDataForUpload);
      this.filesDataForUpload = [];
    },
    deleteUploadedFile: function(fileData){
      // Using the default uploader. You may use another uploader instead.
      this.$refs.vueFileAgent.deleteUpload(this.uploadUrl, this.uploadHeaders, fileData);
    },
    filesSelected: function(filesData){
      var validFilesData = [];
      for(var i = 0; i < filesData.length; i++){
        if(!filesData[i].error){
          validFilesData.push(filesData[i]);
        }
      }
      console.log('filesSelected', filesData, validFilesData);
      this.filesDataForUpload = this.filesDataForUpload.concat(validFilesData);
    },
    fileDeleted: function(fileData){
      var i = this.filesDataForUpload.indexOf(fileData);
      if(i !== -1){
        this.filesDataForUpload.splice(i, 1);
      }
      else {
        this.deleteUploadedFile(fileData);
      }
    },

  }
}
      component.template = '#demo-advanced-template';
      components['demo-advanced'] = component;
      // Vue.component('demo-advanced', component);
    })();
  </script>

  <script type="text/javascript">
    // Vue.component

    var vm = new Vue({
      el: '#app',
      components: components,
    });
  </script>

</body>
</html>